<!DOCTYPE html>
<html>

	<head>
		
		<title>Geo Example</title>
		
		<style>
			
			html, body {
				height: 100%;
				margin: 0;
				padding: 0;
			}
			
			#map {
				height: 100%;
			}
			
		</style>
		
	</head>

	<body>

    		<div id="map"></div>
		
		<script>
			
			var urlParams = new URLSearchParams(window.location.search);
			var JSElement = document.createElement('script');
			JSElement.src = "https://maps.googleapis.com/maps/api/js?key=" + urlParams.get('token');// + "&callback=initMap";
			JSElement.defer = true;
			JSElement.onload = initMap;
			document.getElementsByTagName('head')[0].appendChild(JSElement);
			
			function initMap() {
				
				map = new google.maps.Map(document.getElementById('map'), {
					zoom: 4,
					center: {lng: -98.5556199, lat: 39.8097343},
					mapTypeId: 'terrain'
				});
			
				var locations = [
					[767, 839, 100], // cell 1
					[65, 9, 89],     // cell 2
					[543, 558, 804]  // cell 3
				];

				var dmaData;
				fetch('https://raw.githubusercontent.com/simzou/nielsen-dma/master/nielsen-mkt-map.json')
					.then(res => res.json())
					.then((out) => {
						console.log(dmaData);
					})
					.catch(err => console.error(err));
				
// 				for (var locationList in locations) {
// 					console.log('locationList: ' + locationList);
// 					for (var location in locationList) {
// 						console.log('location: ' + location);
// 						var geoData = dmaData.features.filter(function(data) { 
// 							return data.properties.dma_code == location 
// 						});
// 						console.log('geoData: ' + geoData);			      
// 					}
// 				}
			}
			
		</script>
		
	</body>

</html>
